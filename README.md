# Read Tobii Glasses

# Интерпретатор Python 3.x

В программе использован модуль pandas. Если вы работаете под Windows, рекомендуется установить дистрибутив Anaconda Python 3.x (<https://www.anaconda.com/download/>). Рекомендуется устанавливать от имени Администратора. Под MacOS и Linux после установки стандартного Python 3 (python.org/downloads/) достаточно воспользоваться встроенным средством установки пакетов:

    python -m pip install pandas
	
	
# Установка

Для установки пакетов зависимостей автоматически (pympi-ling, sqlalchemy, skinematics) перед первым использованием программы воспользуйтесь менеджером пакетов (pip):

    python -m pip install -r requirements.txt
	
	
Также для сохранения анимации гироскопа необходимо иметь на компьютере утилиту ffmpeg, внесенную в переменную среды PATH.


## Данные

Данные айтрекинга необходимо экспортировать через Tobii ProLab в формат tsv. При экспорте нужно отметить галочки для Recording timestamp, Gaze point, Gaze 3D Position, Gaze direction, Pupil position, Pupil diameter, Eye movement type, Gaze event, Gyro, Accelerometer. Рекомендуется убрать галочки для Project name, Export date, Recording start time, Recording duration, Recording Fixation filter name, а также всех полей Mapped (если вы не используете автоматическое картирование на AOI).

Из столбцов времени считываются абсолютные значения, как привязанные к общему нулю для всех каналов для данного участника. При этом столбец с временной меткой не обязательно должен начинаться с 0:00.000, но это значение должно иметь привязку к общему нулю.


## Описание файла settings.xml

Данный файл содержит список всех файлов с данными, которые требуется подвергнуть анализу, а также временные границы этапов эксперимента. В полях path указываются относительные пути к файлам с данными от данного XML-файла настроек. Рекомендуется скопировать данный файл в папку с данными, после чего внести в него изменения в соответствии с пакетом данных.

Поле zeroTime указывается для тех файлов, временная метка в которых начинается не с момента первого этапа, т.е. тех, которые еще не обрезаны. Обычно в пакете данных перед началом анализа уже произведена обрезка, поэтому данное поле нужно только в файлах типа ey и gaze (данные с айтрекера). Если несколько файлов имеют одинаковые временные поправки, укажите zeroTime только для одного файла. Остальным назначьте в качестве значения zeroTime атрибут 'type' того файла, который содержит такую же дельту.

Порядок полей interval играет роль при подсчете их временных границ. Длительности этапов складываются, начиная с первого, позволяя вычислить момент начала и конца каждого этапа, и при этом файл не содержит избыточных данных и потенциальных ошибок из-за двусмысленности полей.

Все временные параметры рекомендуется указывать в формате 0:00.000

Оставьте поле id для интервала пустым или назовите его '_empty' или '_trans', если нужно исключить его из анализа.

Некоторые значения поля id являются служебными. Они начинаются со знака _. Не используйте их для обычных интервалов.

Если требуется исключить какой-то файл из анализа, просто удалите всю строку <file>.


## Описание пакетного .bat-файла (.sh под MacOS и Linux)

Утилита поддерживает режим запуска из командной строки. При этом окно интерфейса будет отображаться на экране, но взаимодействие с ним будет недоступно. Все необходимые функции при этом выполнятся автоматически, и сгенерируется статистический отчет.

Чтобы последовательно произвести анализ нескольких пакетов данных, без вмешательства пользователя, создайте bat-файл состоящий из нескольких строк. В каждой строке должен быть указан абсолютный путь в XML-файлу настроек. Отчеты при этом сохранятся в папки с данными, каждый в свою.

Такой многострочный bat-файл затем может быть использован для получения сводной таблицы по проведенным статистическим расчетам. Для этого используйте пункт меню Settings>Run batch and pivot tables... Выберите ваш bat-файл, и ждите завершения работы программы. В текстовом поле должно появиться сообщение Batch complete. Pivot tables ready. А в папке с утилитой появится папка batch_дата, где будут ваши сводные таблицы по всем указанным пакетам данных.